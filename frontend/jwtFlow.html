<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JWT Authentication Flow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .flow-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
      }
      .flow-step {
        margin-bottom: 30px;
        position: relative;
      }
      .flow-step:not(:last-child):after {
        content: "";
        position: absolute;
        bottom: -20px;
        left: 20px;
        width: 2px;
        height: 20px;
        background-color: #3b82f6;
      }
      .token-life {
        background-color: #f1f5f9;
        border-radius: 8px;
        padding: 15px;
        margin-top: 20px;
      }
      .code-block {
        background-color: #1e293b;
        color: #e2e8f0;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 14px;
        overflow-x: auto;
        margin: 10px 0;
      }
    </style>
  </head>
  <body class="bg-slate-50">
    <div class="flow-container">
      <h1 class="text-3xl font-bold text-center mb-10 text-slate-800">JWT Authentication Flow</h1>

      <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-xl font-semibold mb-4 text-slate-700">How Your Authentication System Works</h2>
        <p class="mb-4">Your application uses a secure JWT-based authentication system with access tokens and refresh tokens.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div class="bg-blue-50 p-4 rounded-lg">
            <h3 class="font-medium text-blue-800">Access Token</h3>
            <ul class="mt-2 text-sm text-blue-700">
              <li>• Short-lived (15-60 minutes)</li>
              <li>• Sent with API requests</li>
              <li>• Stored in memory (Zustand store)</li>
            </ul>
          </div>
          <div class="bg-green-50 p-4 rounded-lg">
            <h3 class="font-medium text-green-800">Refresh Token</h3>
            <ul class="mt-2 text-sm text-green-700">
              <li>• Long-lived (days or weeks)</li>
              <li>• Used to get new access tokens</li>
              <li>• Stored securely (httpOnly cookie or localStorage)</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="flow-step bg-white p-6 rounded-lg shadow-md">
        <div class="flex items-start">
          <div class="bg-blue-500 text-white rounded-full h-10 w-10 flex items-center justify-center mr-4 flex-shrink-0">1</div>
          <div>
            <h3 class="text-lg font-semibold">User Login</h3>
            <p class="mt-2">When a user successfully logs in, the server returns both access and refresh tokens.</p>
            <div class="code-block">
              // After successful login<br />
              login: (user, token, refreshToken) => {<br />
              &nbsp;&nbsp;set({ user, token, refreshToken, isAuthenticated: true });<br />
              &nbsp;&nbsp;localStorage.setItem("refreshToken", refreshToken);<br />
              }
            </div>
          </div>
        </div>
      </div>

      <div class="flow-step bg-white p-6 rounded-lg shadow-md">
        <div class="flex items-start">
          <div class="bg-blue-500 text-white rounded-full h-10 w-10 flex items-center justify-center mr-4 flex-shrink-0">2</div>
          <div>
            <h3 class="text-lg font-semibold">App Initialization</h3>
            <p class="mt-2">When the app loads, it checks for a stored refresh token and attempts to get new tokens.</p>
            <div class="code-block">
              useEffect(() => {<br />
              &nbsp;&nbsp;const init = async () => {<br />
              &nbsp;&nbsp;&nbsp;&nbsp;await initializeAuth();<br />
              &nbsp;&nbsp;&nbsp;&nbsp;setIsInitializing(false);<br />
              &nbsp;&nbsp;};<br />
              &nbsp;&nbsp;init();<br />
              }, [initializeAuth]);
            </div>
          </div>
        </div>
      </div>

      <div class="flow-step bg-white p-6 rounded-lg shadow-md">
        <div class="flex items-start">
          <div class="bg-blue-500 text-white rounded-full h-10 w-10 flex items-center justify-center mr-4 flex-shrink-0">3</div>
          <div>
            <h3 class="text-lg font-semibold">Token Refresh</h3>
            <p class="mt-2">The refresh token is used to obtain a new access token without requiring the user to login again.</p>
            <div class="code-block">
              const response = await authApi.refreshToken({ <br />
              &nbsp;&nbsp;token: storedRefreshToken <br />
              });<br />
              // Server returns new access token and refresh token
            </div>
          </div>
        </div>
      </div>

      <div class="flow-step bg-white p-6 rounded-lg shadow-md">
        <div class="flex items-start">
          <div class="bg-blue-500 text-white rounded-full h-10 w-10 flex items-center justify-center mr-4 flex-shrink-0">4</div>
          <div>
            <h3 class="text-lg font-semibold">API Requests</h3>
            <p class="mt-2">The access token is included in API requests to authenticate the user.</p>
            <div class="code-block">
              // Example API call with authentication<br />
              const response = await fetch('/api/protected-route', {<br />
              &nbsp;&nbsp;headers: {<br />
              &nbsp;&nbsp;&nbsp;&nbsp;'Authorization': `Bearer ${token}`<br />
              &nbsp;&nbsp;}<br />
              });
            </div>
          </div>
        </div>
      </div>

      <div class="flow-step bg-white p-6 rounded-lg shadow-md">
        <div class="flex items-start">
          <div class="bg-blue-500 text-white rounded-full h-10 w-10 flex items-center justify-center mr-4 flex-shrink-0">5</div>
          <div>
            <h3 class="text-lg font-semibold">Token Expiration</h3>
            <p class="mt-2">When the access token expires, the refresh token is used to obtain a new one.</p>
            <div class="code-block">
              // Typically implemented as an axios interceptor<br />
              api.interceptors.response.use(<br />
              &nbsp;&nbsp;(response) => response,<br />
              &nbsp;&nbsp;async (error) => {<br />
              &nbsp;&nbsp;&nbsp;&nbsp;if (error.response.status === 401) {<br />
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Refresh token and retry request<br />
              &nbsp;&nbsp;&nbsp;&nbsp;}<br />
              &nbsp;&nbsp;}<br />
              );
            </div>
          </div>
        </div>
      </div>

      <div class="token-life">
        <h3 class="font-semibold mb-3">Token Lifetime Example</h3>
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm">Access Token</span>
          <span class="text-sm text-blue-600">15-60 minutes</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2.5">
          <div class="bg-blue-600 h-2.5 rounded-full" style="width: 25%"></div>
        </div>

        <div class="flex items-center justify-between mb-2 mt-4">
          <span class="text-sm">Refresh Token</span>
          <span class="text-sm text-green-600">7-30 days</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2.5">
          <div class="bg-green-600 h-2.5 rounded-full" style="width: 90%"></div>
        </div>
      </div>

      <div class="mt-8 bg-yellow-50 p-4 rounded-lg border border-yellow-200">
        <h3 class="font-medium text-yellow-800 mb-2">Security Note</h3>
        <p class="text-yellow-700 text-sm">While storing refresh tokens in localStorage works, for enhanced security consider using httpOnly cookies for refresh tokens to protect against XSS attacks.</p>
      </div>
    </div>
  </body>
</html>
